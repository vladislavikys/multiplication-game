<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</title>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <div id="root"></div>

    <script>
        // üî• –í–ê–®–ê FIREBASE –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø (–¢–ê –ñ–ï, –ß–¢–û –í index.html)
        const firebaseConfig = {
          apiKey: "AIzaSyCCUcNvmsdh0nsaZler0PQCrqJfNvEHifY",
          authDomain: "multiplication-game-22120.firebaseapp.com",
          projectId: "multiplication-game-22120",
          storageBucket: "multiplication-game-22120.firebasestorage.app",
          messagingSenderId: "797459824775",
          appId: "1:797459824775:web:ce953848b79dd3889b3822"
        };

        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }
        const auth = firebase.auth();
        const db = firebase.firestore();

        // ============================================
        // –ì–õ–ê–í–ù–´–ô –ö–û–î –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–ò
        // ============================================

        let currentUser = null;
        let allCodes = [];

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        auth.onAuthStateChanged(async (user) => {
            if (user) {
                currentUser = user;
                document.getElementById('auth-section').style.display = 'none';
                document.getElementById('admin-panel').style.display = 'block';
                document.getElementById('admin-email').textContent = user.email;
                await loadAllCodes();
            } else {
                currentUser = null;
                document.getElementById('auth-section').style.display = 'block';
                document.getElementById('admin-panel').style.display = 'none';
            }
        });

        // –í—Ö–æ–¥
        async function login() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            try {
                await auth.signInWithEmailAndPassword(email, password);
                showMessage('‚úÖ –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥!', 'success');
            } catch (error) {
                showMessage('‚ùå –û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞: ' + error.message, 'error');
            }
        }

        // –í—ã—Ö–æ–¥
        async function logout() {
            await auth.signOut();
            showMessage('–í—ã –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã', 'info');
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∫–æ–¥–∞
        function generateRandomCode() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let code = '';
            for (let i = 0; i < 4; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            code += '-';
            for (let i = 0; i < 4; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            document.getElementById('code').value = code;
        }

        // –î–æ–±–∞–≤–∏—Ç—å –∫–æ–¥
        async function addCode() {
            const code = document.getElementById('code').value.toUpperCase().trim();

            if (!code) {
                showMessage('‚ùå –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥!', 'error');
                return;
            }

            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —É–∂–µ —Ç–∞–∫–æ–π –∫–æ–¥
                const existingCode = await db.collection('codes').doc(code).get();
                if (existingCode.exists) {
                    showMessage('‚ùå –¢–∞–∫–æ–π –∫–æ–¥ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!', 'error');
                    return;
                }

                // –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–¥ (–±–µ—Å—Å—Ä–æ—á–Ω–∞—è –ª–∏—Ü–µ–Ω–∑–∏—è)
                await db.collection('codes').doc(code).set({
                    used: false,
                    usedBy: null,
                    usedByEmail: null,
                    usedAt: null,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    createdBy: currentUser.email
                });

                showMessage(`‚úÖ –ö–æ–¥ ${code} —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω! (–±–µ—Å—Å—Ä–æ—á–Ω–∞—è –ª–∏—Ü–µ–Ω–∑–∏—è)`, 'success');

                // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
                document.getElementById('code').value = '';

                // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫
                await loadAllCodes();

            } catch (error) {
                if (error.code === 'permission-denied') {
                    showMessage('‚ùå –£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–¥–æ–≤! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤–∞—à email —É–∫–∞–∑–∞–Ω –≤ firestore.rules', 'error');
                } else {
                    showMessage('‚ùå –û—à–∏–±–∫–∞: ' + error.message, 'error');
                }
            }
        }

        // –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ –∫–æ–¥—ã
        async function loadAllCodes() {
            try {
                const snapshot = await db.collection('codes')
                    .orderBy('createdAt', 'desc')
                    .get();

                allCodes = [];
                snapshot.forEach(doc => {
                    allCodes.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });

                displayCodes();

            } catch (error) {
                console.error('Error loading codes:', error);
                showMessage('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–¥–æ–≤', 'error');
            }
        }

        // –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∫–æ–¥—ã
        function displayCodes() {
            const tbody = document.getElementById('codes-list');
            tbody.innerHTML = '';

            const stats = {
                total: allCodes.length,
                used: allCodes.filter(c => c.used).length,
                available: allCodes.filter(c => !c.used).length
            };

            document.getElementById('stat-total').textContent = stats.total;
            document.getElementById('stat-used').textContent = stats.used;
            document.getElementById('stat-available').textContent = stats.available;

            allCodes.forEach(code => {
                const row = document.createElement('tr');
                row.className = code.used ? 'bg-red-50' : 'bg-green-50';

                const usedDate = code.usedAt ? new Date(code.usedAt.toDate()).toLocaleString('ru-RU') : '-';
                const createdDate = code.createdAt ? new Date(code.createdAt.toDate()).toLocaleString('ru-RU') : '-';

                row.innerHTML = `
                    <td class="px-4 py-3 font-bold text-lg">${code.id}</td>
                    <td class="px-4 py-3 text-center">
                        ${code.used
                            ? '<span class="bg-red-500 text-white px-3 py-1 rounded-full font-bold">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω</span>'
                            : '<span class="bg-green-500 text-white px-3 py-1 rounded-full font-bold">–î–æ—Å—Ç—É–ø–µ–Ω</span>'}
                    </td>
                    <td class="px-4 py-3 text-sm text-gray-600">${code.usedByEmail || '-'}</td>
                    <td class="px-4 py-3 text-sm text-gray-600">${usedDate}</td>
                    <td class="px-4 py-3 text-sm text-gray-600">${createdDate}</td>
                    <td class="px-4 py-3 text-center">
                        ${!code.used ? `<button onclick="deleteCode('${code.id}')" class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded font-bold">–£–¥–∞–ª–∏—Ç—å</button>` : '-'}
                    </td>
                `;

                tbody.appendChild(row);
            });
        }

        // –£–¥–∞–ª–∏—Ç—å –∫–æ–¥ (—Ç–æ–ª—å–∫–æ –Ω–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ)
        async function deleteCode(codeId) {
            if (!confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∫–æ–¥ ${codeId}?`)) {
                return;
            }

            try {
                await db.collection('codes').doc(codeId).delete();
                showMessage(`‚úÖ –ö–æ–¥ ${codeId} —É–¥–∞–ª–µ–Ω`, 'success');
                await loadAllCodes();
            } catch (error) {
                showMessage('‚ùå –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è: ' + error.message, 'error');
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
        function showMessage(text, type) {
            const messageDiv = document.getElementById('message');
            messageDiv.textContent = text;
            messageDiv.className = `p-4 rounded-lg font-bold mb-4 ${
                type === 'success' ? 'bg-green-100 text-green-800 border-2 border-green-500' :
                type === 'error' ? 'bg-red-100 text-red-800 border-2 border-red-500' :
                'bg-blue-100 text-blue-800 border-2 border-blue-500'
            }`;
            messageDiv.style.display = 'block';

            setTimeout(() => {
                messageDiv.style.display = 'none';
            }, 5000);
        }

        // –ú–∞—Å—Å–æ–≤–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–¥–æ–≤
        async function bulkCreateCodes() {
            const count = parseInt(document.getElementById('bulk-count').value);

            if (!count || count <= 0 || count > 100) {
                showMessage('‚ùå –í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç 1 –¥–æ 100', 'error');
                return;
            }

            if (!confirm(`–°–æ–∑–¥–∞—Ç—å ${count} –∫–æ–¥–æ–≤ –±–µ—Å—Å—Ä–æ—á–Ω–æ–π –ª–∏—Ü–µ–Ω–∑–∏–∏?`)) {
                return;
            }

            const createdCodes = [];
            let errors = 0;

            for (let i = 0; i < count; i++) {
                try {
                    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–æ–¥
                    let code;
                    let attempts = 0;
                    do {
                        const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
                        code = '';
                        for (let j = 0; j < 4; j++) {
                            code += chars.charAt(Math.floor(Math.random() * chars.length));
                        }
                        code += '-';
                        for (let j = 0; j < 4; j++) {
                            code += chars.charAt(Math.floor(Math.random() * chars.length));
                        }
                        attempts++;
                    } while (createdCodes.includes(code) && attempts < 10);

                    if (attempts >= 10) {
                        errors++;
                        continue;
                    }

                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–æ–¥ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
                    const existingCode = await db.collection('codes').doc(code).get();
                    if (existingCode.exists) {
                        errors++;
                        continue;
                    }

                    // –°–æ–∑–¥–∞–µ–º –∫–æ–¥ (–±–µ—Å—Å—Ä–æ—á–Ω–∞—è –ª–∏—Ü–µ–Ω–∑–∏—è)
                    await db.collection('codes').doc(code).set({
                        used: false,
                        usedBy: null,
                        usedByEmail: null,
                        usedAt: null,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        createdBy: currentUser.email
                    });

                    createdCodes.push(code);

                } catch (error) {
                    console.error('Error creating code:', error);
                    errors++;
                }
            }

            showMessage(`‚úÖ –°–æ–∑–¥–∞–Ω–æ ${createdCodes.length} –∫–æ–¥–æ–≤${errors > 0 ? ` (–æ—à–∏–±–æ–∫: ${errors})` : ''}`, 'success');

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∫–æ–¥—ã
            document.getElementById('created-codes-list').textContent = createdCodes.join('\n');

            await loadAllCodes();
        }

        // ============================================
        // –ú–û–ù–ò–¢–û–†–ò–ù–ì –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô
        // ============================================

        let allUsers = [];
        let allSessions = [];

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        function switchTab(tab) {
            if (tab === 'codes') {
                document.getElementById('codes-section').style.display = 'block';
                document.getElementById('users-section').style.display = 'none';
                document.getElementById('tab-codes').className = 'px-6 py-3 font-bold text-purple-600 border-b-4 border-purple-600';
                document.getElementById('tab-users').className = 'px-6 py-3 font-bold text-gray-500 hover:text-purple-600';
            } else {
                document.getElementById('codes-section').style.display = 'none';
                document.getElementById('users-section').style.display = 'block';
                document.getElementById('tab-codes').className = 'px-6 py-3 font-bold text-gray-500 hover:text-purple-600';
                document.getElementById('tab-users').className = 'px-6 py-3 font-bold text-purple-600 border-b-4 border-purple-600';
                loadAllUsers();
            }
        }

        // –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        async function loadAllUsers() {
            try {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                const usersSnapshot = await db.collection('users').get();
                allUsers = [];
                usersSnapshot.forEach(doc => {
                    allUsers.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });

                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–µ—Å—Å–∏–∏
                const sessionsSnapshot = await db.collection('sessions').get();
                allSessions = [];
                sessionsSnapshot.forEach(doc => {
                    allSessions.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });

                // –ü–æ–ª—É—á–∞–µ–º auth –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è email
                const authUsers = {};
                try {
                    // –≠—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∞
                    // –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –Ω—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å email –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                } catch (e) {
                    console.log('Cannot fetch auth users');
                }

                displayUsers();

            } catch (error) {
                console.error('Error loading users:', error);
                showMessage('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π', 'error');
            }
        }

        // –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        function displayUsers() {
            const tbody = document.getElementById('users-list');
            tbody.innerHTML = '';

            // –°—á–∏—Ç–∞–µ–º –æ–Ω–ª–∞–π–Ω (–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 2 –º–∏–Ω—É—Ç—ã)
            const now = Date.now();
            const twoMinutesAgo = now - 2 * 60 * 1000;

            const usersWithSessions = allUsers.map(user => {
                const session = allSessions.find(s => s.userId === user.id);
                return { ...user, session };
            });

            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            const stats = {
                total: allUsers.length,
                online: usersWithSessions.filter(u => {
                    if (!u.session || !u.session.lastSeen) return false;
                    const lastSeen = u.session.lastSeen.toDate ? u.session.lastSeen.toDate().getTime() : 0;
                    return lastSeen > twoMinutesAgo && u.session.isActive;
                }).length,
                licensed: allUsers.filter(u => u.hasLicense).length,
                free: allUsers.filter(u => !u.hasLicense).length
            };

            document.getElementById('stat-users-total').textContent = stats.total;
            document.getElementById('stat-users-online').textContent = stats.online;
            document.getElementById('stat-users-licensed').textContent = stats.licensed;
            document.getElementById('stat-users-free').textContent = stats.free;

            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            usersWithSessions.forEach(user => {
                const session = user.session;
                const isOnline = session && session.lastSeen && session.isActive &&
                    session.lastSeen.toDate().getTime() > twoMinutesAgo;

                const row = document.createElement('tr');
                row.className = isOnline ? 'bg-green-50' : 'bg-gray-50';

                const lastSeen = session && session.lastSeen
                    ? new Date(session.lastSeen.toDate()).toLocaleString('ru-RU')
                    : '–ù–∏–∫–æ–≥–¥–∞';

                const deviceInfo = session
                    ? `${session.platform || 'Unknown'} - ${(session.userAgent || '').substring(0, 50)}...`
                    : '-';

                row.innerHTML = `
                    <td class="px-4 py-3 text-center">
                        ${isOnline
                            ? '<span class="text-3xl">üü¢</span>'
                            : '<span class="text-3xl">‚ö™</span>'}
                    </td>
                    <td class="px-4 py-3 font-bold">${user.email || user.id}</td>
                    <td class="px-4 py-3 text-center">
                        ${user.hasLicense
                            ? '<span class="bg-green-500 text-white px-3 py-1 rounded-full font-bold">‚úÖ –ï—Å—Ç—å</span>'
                            : '<span class="bg-gray-500 text-white px-3 py-1 rounded-full font-bold">‚ùå –ù–µ—Ç</span>'}
                    </td>
                    <td class="px-4 py-3 text-sm">${session?.ipAddress || '-'}</td>
                    <td class="px-4 py-3 text-xs text-gray-600">${deviceInfo}</td>
                    <td class="px-4 py-3 text-sm">${lastSeen}</td>
                    <td class="px-4 py-3 text-sm font-mono text-xs">${user.activatedCodes?.join(', ') || '-'}</td>
                `;

                tbody.appendChild(row);
            });
        }

        // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
        setInterval(() => {
            if (document.getElementById('users-section').style.display !== 'none') {
                loadAllUsers();
            }
        }, 10000);
    </script>

    <div class="min-h-screen p-8">
        <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
        <div id="message" style="display: none;"></div>

        <!-- –§–û–†–ú–ê –í–•–û–î–ê -->
        <div id="auth-section" style="display: none;" class="max-w-md mx-auto">
            <div class="bg-white rounded-lg shadow-lg p-8 border-4 border-purple-400">
                <div class="text-center mb-6">
                    <div class="text-6xl mb-4">üîê</div>
                    <h1 class="text-3xl font-black text-purple-600">–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h1>
                    <p class="text-gray-600 mt-2">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞–º–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏</p>
                </div>

                <input id="email" type="email" placeholder="Email –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞"
                    class="w-full border-2 border-purple-300 rounded-lg p-3 mb-4 focus:outline-none focus:border-purple-500">

                <input id="password" type="password" placeholder="–ü–∞—Ä–æ–ª—å"
                    class="w-full border-2 border-purple-300 rounded-lg p-3 mb-6 focus:outline-none focus:border-purple-500"
                    onkeypress="if(event.key==='Enter') login()">

                <button onclick="login()"
                    class="w-full bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 rounded-lg">
                    üîì –í–û–ô–¢–ò
                </button>
            </div>
        </div>

        <!-- –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨ -->
        <div id="admin-panel" style="display: none;">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
            <div class="bg-white rounded-lg shadow-lg p-6 mb-8 border-4 border-purple-400">
                <div class="flex justify-between items-center">
                    <div>
                        <h1 class="text-4xl font-black text-purple-600 mb-2">üéÆ –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h1>
                        <p class="text-gray-600">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞–º–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏</p>
                        <p class="text-sm text-gray-500 mt-1">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä: <span id="admin-email" class="font-bold"></span></p>
                    </div>
                    <button onclick="logout()"
                        class="bg-red-500 hover:bg-red-600 text-white font-bold px-6 py-3 rounded-lg">
                        üö™ –í—ã–π—Ç–∏
                    </button>
                </div>

                <!-- –í–∫–ª–∞–¥–∫–∏ -->
                <div class="flex gap-4 mt-6 border-b-2 border-purple-200">
                    <button id="tab-codes" onclick="switchTab('codes')"
                        class="px-6 py-3 font-bold text-purple-600 border-b-4 border-purple-600">
                        üîë –ö–æ–¥—ã –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
                    </button>
                    <button id="tab-users" onclick="switchTab('users')"
                        class="px-6 py-3 font-bold text-gray-500 hover:text-purple-600">
                        üë• –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                    </button>
                </div>
            </div>

            <!-- –í–ö–õ–ê–î–ö–ê: –ö–æ–¥—ã –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ -->
            <div id="codes-section">
            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="grid grid-cols-3 gap-4 mb-8">
                <div class="bg-blue-500 text-white rounded-lg shadow-lg p-6 text-center">
                    <div class="text-4xl font-black" id="stat-total">0</div>
                    <div class="text-sm font-bold mt-2">–í—Å–µ–≥–æ –∫–æ–¥–æ–≤</div>
                </div>
                <div class="bg-green-500 text-white rounded-lg shadow-lg p-6 text-center">
                    <div class="text-4xl font-black" id="stat-available">0</div>
                    <div class="text-sm font-bold mt-2">–î–æ—Å—Ç—É–ø–Ω–æ</div>
                </div>
                <div class="bg-red-500 text-white rounded-lg shadow-lg p-6 text-center">
                    <div class="text-4xl font-black" id="stat-used">0</div>
                    <div class="text-sm font-bold mt-2">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ</div>
                </div>
            </div>

            <!-- –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–¥–∞ -->
            <div class="grid grid-cols-2 gap-8 mb-8">
                <!-- –û–¥–∏–Ω–æ—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ -->
                <div class="bg-white rounded-lg shadow-lg p-6 border-2 border-purple-300">
                    <h2 class="text-2xl font-black text-purple-600 mb-4">‚ûï –°–æ–∑–¥–∞—Ç—å –∫–æ–¥</h2>

                    <div class="mb-4">
                        <label class="block text-gray-700 font-bold mb-2">–ö–æ–¥ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏:</label>
                        <div class="flex gap-2">
                            <input id="code" type="text" placeholder="XXXX-XXXX" maxlength="9"
                                class="flex-1 border-2 border-purple-300 rounded-lg p-3 font-bold uppercase text-lg focus:outline-none focus:border-purple-500"
                                style="text-transform: uppercase;">
                            <button onclick="generateRandomCode()"
                                class="bg-gray-500 hover:bg-gray-600 text-white font-bold px-4 rounded-lg">
                                üé≤
                            </button>
                        </div>
                    </div>

                    <div class="mb-6 bg-green-50 border-2 border-green-300 rounded-lg p-4">
                        <p class="text-green-800 font-bold text-center">
                            üéâ –ë–µ—Å—Å—Ä–æ—á–Ω–∞—è –ª–∏—Ü–µ–Ω–∑–∏—è<br/>
                            <span class="text-sm">–ö–æ–¥ –¥–∞–µ—Ç –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –Ω–∞–≤—Å–µ–≥–¥–∞</span>
                        </p>
                    </div>

                    <button onclick="addCode()"
                        class="w-full bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 rounded-lg text-lg">
                        ‚úÖ –°–û–ó–î–ê–¢–¨ –ö–û–î
                    </button>
                </div>

                <!-- –ú–∞—Å—Å–æ–≤–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ -->
                <div class="bg-white rounded-lg shadow-lg p-6 border-2 border-green-300">
                    <h2 class="text-2xl font-black text-green-600 mb-4">‚ö° –ú–∞—Å—Å–æ–≤–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ</h2>

                    <div class="mb-4">
                        <label class="block text-gray-700 font-bold mb-2">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–¥–æ–≤:</label>
                        <input id="bulk-count" type="number" value="10" min="1" max="100"
                            class="w-full border-2 border-green-300 rounded-lg p-3 font-bold text-lg focus:outline-none focus:border-green-500">
                    </div>

                    <div class="mb-6 bg-green-50 border-2 border-green-300 rounded-lg p-4">
                        <p class="text-green-800 font-bold text-center">
                            üéâ –ë–µ—Å—Å—Ä–æ—á–Ω—ã–µ –ª–∏—Ü–µ–Ω–∑–∏–∏<br/>
                            <span class="text-sm">–ö–∞–∂–¥—ã–π –∫–æ–¥ –¥–∞–µ—Ç –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –Ω–∞–≤—Å–µ–≥–¥–∞</span>
                        </p>
                    </div>

                    <button onclick="bulkCreateCodes()"
                        class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 rounded-lg text-lg">
                        ‚ö° –°–û–ó–î–ê–¢–¨ –ü–ê–ö–ï–¢
                    </button>

                    <div class="mt-4">
                        <label class="block text-gray-700 font-bold mb-2">–°–æ–∑–¥–∞–Ω–Ω—ã–µ –∫–æ–¥—ã:</label>
                        <textarea id="created-codes-list" readonly
                            class="w-full h-32 border-2 border-gray-300 rounded-lg p-2 text-sm font-mono bg-gray-50"
                            placeholder="–°–æ–∑–¥–∞–Ω–Ω—ã–µ –∫–æ–¥—ã –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å..."></textarea>
                    </div>
                </div>
            </div>

            <!-- –¢–∞–±–ª–∏—Ü–∞ –∫–æ–¥–æ–≤ -->
            <div class="bg-white rounded-lg shadow-lg p-6 border-2 border-purple-300">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-black text-purple-600">üìã –í—Å–µ –∫–æ–¥—ã</h2>
                    <button onclick="loadAllCodes()"
                        class="bg-blue-500 hover:bg-blue-600 text-white font-bold px-4 py-2 rounded-lg">
                        üîÑ –û–±–Ω–æ–≤–∏—Ç—å
                    </button>
                </div>

                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-purple-500 text-white">
                            <tr>
                                <th class="px-4 py-3 text-left font-bold">–ö–æ–¥</th>
                                <th class="px-4 py-3 text-center font-bold">–°—Ç–∞—Ç—É—Å</th>
                                <th class="px-4 py-3 text-left font-bold">Email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</th>
                                <th class="px-4 py-3 text-left font-bold">–î–∞—Ç–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏</th>
                                <th class="px-4 py-3 text-left font-bold">–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è</th>
                                <th class="px-4 py-3 text-center font-bold">–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody id="codes-list">
                            <!-- –ö–æ–¥—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –∑–¥–µ—Å—å -->
                        </tbody>
                    </table>
                </div>
            </div>
            </div>
            <!-- –ö–æ–Ω–µ—Ü –í–ö–õ–ê–î–ö–ê: –ö–æ–¥—ã –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ -->

            <!-- –í–ö–õ–ê–î–ö–ê: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
            <div id="users-section" style="display: none;">
                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
                <div class="grid grid-cols-4 gap-4 mb-8">
                    <div class="bg-green-500 text-white rounded-lg shadow-lg p-6 text-center">
                        <div class="text-4xl font-black" id="stat-users-total">0</div>
                        <div class="text-sm font-bold mt-2">–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                    </div>
                    <div class="bg-blue-500 text-white rounded-lg shadow-lg p-6 text-center">
                        <div class="text-4xl font-black" id="stat-users-online">0</div>
                        <div class="text-sm font-bold mt-2">üü¢ –û–Ω–ª–∞–π–Ω</div>
                    </div>
                    <div class="bg-purple-500 text-white rounded-lg shadow-lg p-6 text-center">
                        <div class="text-4xl font-black" id="stat-users-licensed">0</div>
                        <div class="text-sm font-bold mt-2">–° –ª–∏—Ü–µ–Ω–∑–∏–µ–π</div>
                    </div>
                    <div class="bg-orange-500 text-white rounded-lg shadow-lg p-6 text-center">
                        <div class="text-4xl font-black" id="stat-users-free">0</div>
                        <div class="text-sm font-bold mt-2">–ë–µ–∑ –ª–∏—Ü–µ–Ω–∑–∏–∏</div>
                    </div>
                </div>

                <!-- –¢–∞–±–ª–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
                <div class="bg-white rounded-lg shadow-lg p-6 border-2 border-purple-300">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-2xl font-black text-purple-600">üë• –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h2>
                        <button onclick="loadAllUsers()"
                            class="bg-blue-500 hover:bg-blue-600 text-white font-bold px-4 py-2 rounded-lg">
                            üîÑ –û–±–Ω–æ–≤–∏—Ç—å
                        </button>
                    </div>

                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-purple-500 text-white">
                                <tr>
                                    <th class="px-4 py-3 text-left font-bold">–°—Ç–∞—Ç—É—Å</th>
                                    <th class="px-4 py-3 text-left font-bold">Email</th>
                                    <th class="px-4 py-3 text-center font-bold">–õ–∏—Ü–µ–Ω–∑–∏—è</th>
                                    <th class="px-4 py-3 text-left font-bold">IP –∞–¥—Ä–µ—Å</th>
                                    <th class="px-4 py-3 text-left font-bold">–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ</th>
                                    <th class="px-4 py-3 text-left font-bold">–ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</th>
                                    <th class="px-4 py-3 text-left font-bold">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–¥—ã</th>
                                </tr>
                            </thead>
                            <tbody id="users-list">
                                <!-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –∑–¥–µ—Å—å -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <!-- –ö–æ–Ω–µ—Ü –í–ö–õ–ê–î–ö–ê: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
        </div>
    </div>
</body>
</html>
